
USE  [BEE];
GO
-- Truncate the log by changing the database recovery model to SIMPLE.
ALTER DATABASE [BEE]
SET RECOVERY SIMPLE;
GO
-- Shrink the truncated log file to 1 MB.
DBCC SHRINKFILE (POSM_log, 1);
GO
-- Reset the database recovery model.
ALTER DATABASE [BEE]
SET RECOVERY FULL;
GO



USE  [BEE];
GO
-- Truncate the log by changing the database recovery model to SIMPLE.
ALTER DATABASE [BEE]
SET RECOVERY SIMPLE;
GO
-- Shrink the truncated log file to 1 MB.
DBCC SHRINKFILE (POSM, 1);
GO
-- Reset the database recovery model.
ALTER DATABASE [BEE]
SET RECOVERY FULL;
GO




USE [BEE]
GO

/****** Object:  Table [dbo].[Rpt_PhieuThu]    Script Date: 9/23/2017 11:16:09 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Rpt_PhieuThu](
	[tencongty] [nvarchar](225) NULL,
	[diachicongty] [nvarchar](225) NULL,
	[masothue] [nvarchar](225) NULL,
	[tengiamdoc] [nvarchar](225) NULL,
	[tenketoantruong] [nvarchar](225) NULL,
	[sophieuthu] [int] NOT NULL,
	[ngaychungtu] [datetime] NULL,
	[nguoinoptien] [nvarchar](100) NULL,
	[nguoilapphieu] [nvarchar](100) NULL,
	[diachinguoinop] [nvarchar](225) NULL,
	[lydothu] [nvarchar](225) NULL,
	[sotien] [float] NULL,
	[sotienbangchu] [nvarchar](225) NULL,
	[sochungtugoc] [int] NOT NULL,
	[username] [nvarchar](50) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[tkno] [nvarchar](10) NULL,
	[quyenso] [nvarchar](10) NULL,
	[tkco] [nvarchar](225) NULL,
 CONSTRAINT [PK_tblRpt_PhieuThu] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

------------------

USE [BEE]
GO

/****** Object:  Table [dbo].[RptdetaiCDPS]    Script Date: 9/23/2017 11:19:14 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RptdetaiCDPS](
	[username] [nvarchar](50) NULL,
	[tentk] [nvarchar](225) NULL,
	[Nodk] [float] NULL,
	[Codk] [float] NULL,
	[Psno] [float] NULL,
	[Psco] [float] NULL,
	[Cock] [float] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[Nock] [float] NULL,
	[matk] [nvarchar](50) NULL,
 CONSTRAINT [PK_RptdetaiCDPS] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

-------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RptdetailSoCai]    Script Date: 9/23/2017 11:19:26 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RptdetailSoCai](
	[username] [nvarchar](50) NULL,
	[Ngaychungtu] [datetime] NULL,
	[machungtu] [nvarchar](10) NOT NULL,
	[diengiai] [nvarchar](225) NULL,
	[taikhoandoiung] [nvarchar](50) NULL,
	[psco] [float] NULL,
	[psno] [float] NULL,
	[ton] [float] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_RptdetailSoCai] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RptdetailSocaichitiet]    Script Date: 9/23/2017 11:19:37 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RptdetailSocaichitiet](
	[username] [nvarchar](50) NULL,
	[Ngaychungtu] [datetime] NULL,
	[machungtu] [nvarchar](10) NOT NULL,
	[diengiai] [nvarchar](225) NULL,
	[taikhoandoiung] [nvarchar](50) NULL,
	[psco] [float] NULL,
	[psno] [float] NULL,
	[ton] [float] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_RptdetailSocaichitiet] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

------------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RptdetailSoQuy]    Script Date: 9/23/2017 11:19:51 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RptdetailSoQuy](
	[username] [nvarchar](50) NULL,
	[Ngaychungtu] [datetime] NULL,
	[machungtuthu] [nvarchar](10) NOT NULL,
	[machungtuchi] [nvarchar](10) NULL,
	[diengiai] [nvarchar](225) NULL,
	[taikhoandoiung] [nvarchar](50) NULL,
	[psco] [float] NULL,
	[psno] [float] NULL,
	[ton] [float] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_RptdetailSoQuy] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

--------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RptdetaiNKC]    Script Date: 9/23/2017 11:20:04 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RptdetaiNKC](
	[username] [nvarchar](50) NULL,
	[Ngaychungtu] [datetime] NULL,
	[machungtu] [nvarchar](10) NOT NULL,
	[diengiai] [nvarchar](225) NULL,
	[taikhoandoiung] [nvarchar](50) NULL,
	[psco] [float] NULL,
	[psno] [float] NULL,
	[ton] [float] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_RptdetaiNKC] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RptdetaiTHchitiet]    Script Date: 9/23/2017 11:20:14 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RptdetaiTHchitiet](
	[username] [nvarchar](50) NULL,
	[tenchitiet] [nvarchar](225) NULL,
	[stt] [int] NULL,
	[Nodk] [float] NULL,
	[Codk] [float] NULL,
	[Psno] [float] NULL,
	[Psco] [float] NULL,
	[Cock] [float] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[Nock] [float] NULL,
	[machitiet] [int] NULL,
 CONSTRAINT [PK_RptdetaiTHchitiet] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

--------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RPtheadCDPS]    Script Date: 9/23/2017 11:20:25 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RPtheadCDPS](
	[tungay] [datetime] NULL,
	[denngay] [datetime] NULL,
	[giamdoc] [nvarchar](50) NULL,
	[ketoantruong] [nvarchar](50) NULL,
	[nguoighiso] [nvarchar](50) NULL,
	[tencongty] [nvarchar](225) NULL,
	[masothue] [nvarchar](50) NULL,
	[diachicongty] [nvarchar](225) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
	[taikhoan] [nvarchar](50) NULL,
 CONSTRAINT [PK_RPtheadCDPS] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RPtheadNKC]    Script Date: 9/23/2017 11:20:35 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RPtheadNKC](
	[nam] [nvarchar](4) NULL,
	[giamdoc] [nvarchar](50) NULL,
	[ketoantruong] [nvarchar](50) NULL,
	[nguoighiso] [nvarchar](50) NULL,
	[tencongty] [nvarchar](225) NULL,
	[masothue] [nvarchar](50) NULL,
	[diachicongty] [nvarchar](225) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
	[taikhoan] [nvarchar](50) NULL,
 CONSTRAINT [PK_RPtheadNKC] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

-------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RPtheadSocai]    Script Date: 9/23/2017 11:20:45 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RPtheadSocai](
	[tungay] [datetime] NULL,
	[denngay] [datetime] NULL,
	[nodauky] [float] NULL,
	[codauky] [float] NULL,
	[psno] [float] NULL,
	[psco] [float] NULL,
	[cocuoiky] [float] NULL,
	[nocuoiky] [float] NULL,
	[tencongty] [nvarchar](225) NULL,
	[masothue] [nvarchar](50) NULL,
	[diachicongty] [nvarchar](225) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
	[taikhoan] [nvarchar](50) NULL,
 CONSTRAINT [PK_RPtheadSocai] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RPtheadSocaichitiet]    Script Date: 9/23/2017 11:20:54 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RPtheadSocaichitiet](
	[tungay] [datetime] NULL,
	[denngay] [datetime] NULL,
	[nodauky] [float] NULL,
	[codauky] [float] NULL,
	[psno] [float] NULL,
	[psco] [float] NULL,
	[cocuoiky] [float] NULL,
	[nocuoiky] [float] NULL,
	[tencongty] [nvarchar](225) NULL,
	[masothue] [nvarchar](50) NULL,
	[diachicongty] [nvarchar](225) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
	[taikhoan] [nvarchar](50) NULL,
	[tenchitiettk] [nvarchar](225) NULL,
 CONSTRAINT [PK_RPtheadSocaichitiet] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

-------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RPtheadTHchitiet]    Script Date: 9/23/2017 11:21:04 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RPtheadTHchitiet](
	[tencongty] [nvarchar](225) NULL,
	[masothue] [nvarchar](50) NULL,
	[diachicongty] [nvarchar](225) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
	[taikhoan] [nvarchar](50) NULL,
	[tungay] [datetime] NULL,
	[denngay] [datetime] NULL,
 CONSTRAINT [PK_RPtheadTHchitiet] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[RPtsoQuy]    Script Date: 9/23/2017 11:21:13 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RPtsoQuy](
	[loaiquy] [nvarchar](50) NULL,
	[tungay] [datetime] NULL,
	[denngay] [datetime] NULL,
	[nodauky] [float] NULL,
	[codauky] [float] NULL,
	[psno] [float] NULL,
	[psco] [float] NULL,
	[cocuoiky] [float] NULL,
	[nocuoiky] [float] NULL,
	[tencongty] [nvarchar](225) NULL,
	[masothue] [nvarchar](50) NULL,
	[diachicongty] [nvarchar](225) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
	[taikhoan] [nvarchar](50) NULL,
 CONSTRAINT [PK_RPtsoQuy] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

--------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_congty]    Script Date: 9/23/2017 11:21:23 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_congty](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[tengiamdoc] [nvarchar](50) NULL,
	[diachicoty] [nvarchar](225) NULL,
	[tencongty] [nvarchar](225) NULL,
	[Masothue] [nvarchar](50) NULL,
	[chedoketoanapdung] [nvarchar](225) NULL,
	[tenketoantruong] [nvarchar](50) NULL,
 CONSTRAINT [PK_congty] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

-----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_Customer]    Script Date: 9/23/2017 11:21:37 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[tbl_Customer](
	[Customer] [float] NULL,
	[SalesOrg] [nvarchar](10) NULL,
	[FullNameN] [nvarchar](255) NULL,
	[Street] [nvarchar](255) NULL,
	[District] [nvarchar](255) NULL,
	[City] [nvarchar](255) NULL,
	[Region] [nvarchar](10) NULL,
	[Telephone1] [nvarchar](50) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[PaymentTerms] [nchar](10) NULL,
	[PriceList] [nchar](10) NULL,
	[KeyAcc] [nvarchar](50) NULL,
	[SalesDistrict] [nvarchar](50) NULL,
	[CreatedOn] [date] NULL,
	[ReconciliationAcct] [nvarchar](50) NULL,
	[VATregistrationNo] [nvarchar](50) NULL,
	[CentralOrBlk] [nvarchar](50) NULL,
	[OrBlk] [varchar](50) NULL,
	[CTDescription] [nvarchar](225) NULL,
	[KANAME] [nvarchar](225) NULL,
	[UPDDAT] [date] NULL,
	[CCDescription] [nvarchar](225) NULL,
	[KAGROUP] [nvarchar](50) NULL,
	[CHN] [nvarchar](50) NULL,
	[BU] [nvarchar](50) NULL,
	[Vendor] [nvarchar](50) NULL,
	[Createdby] [nvarchar](50) NULL,
	[Representative] [nvarchar](225) NULL,
	[Grpcode] [bit] NOT NULL,
	[SFAcode] [bit] NOT NULL,
	[SapCode] [bit] NOT NULL,
	[indirectCode] [bit] NOT NULL,
	[SALORG_CTR] [nchar](10) NULL,
 CONSTRAINT [PK_tblCustomer_1] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

ALTER TABLE [dbo].[tbl_Customer] ADD  CONSTRAINT [DF_tbl_KaCustomer_SapCode1]  DEFAULT ((0)) FOR [Grpcode]
GO

ALTER TABLE [dbo].[tbl_Customer] ADD  CONSTRAINT [DF_tbl_KaCustomer_SapCode2]  DEFAULT ((0)) FOR [SFAcode]
GO

ALTER TABLE [dbo].[tbl_Customer] ADD  CONSTRAINT [DF_tbl_KaCustomer_SapCode]  DEFAULT ((0)) FOR [SapCode]
GO

ALTER TABLE [dbo].[tbl_Customer] ADD  CONSTRAINT [DF_tbl_KaCustomer_SapCode1_1]  DEFAULT ((0)) FOR [indirectCode]
GO

----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_danhsachkhachang]    Script Date: 9/23/2017 11:21:47 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_danhsachkhachang](
	[makhachhang] [nvarchar](50) NULL,
	[tenkhachhang] [nvarchar](255) NULL,
	[sonha] [nvarchar](255) NULL,
	[duongpho] [nvarchar](255) NULL,
	[huyenquan] [nvarchar](255) NULL,
	[thanhpho] [nvarchar](10) NULL,
	[dienthoai] [nvarchar](50) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[masothue] [nvarchar](50) NULL,
	[sotaikhoannganhang] [nvarchar](50) NULL,
	[tennganhang] [nvarchar](225) NULL,
	[ghichunganhnghe] [nvarchar](225) NULL,
	[nguoidaidien] [nvarchar](225) NULL,
	[quocgia] [nvarchar](10) NULL,
	[usertao] [nvarchar](50) NULL,
	[ngaytao] [datetime] NULL,
 CONSTRAINT [PK_tbl_danhsachkhachang] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

-----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_danhsachnhacungcap]    Script Date: 9/23/2017 11:21:56 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_danhsachnhacungcap](
	[maNcc] [nvarchar](50) NULL,
	[tenNcc] [nvarchar](255) NULL,
	[sonha] [nvarchar](255) NULL,
	[duongpho] [nvarchar](255) NULL,
	[huyenquan] [nvarchar](255) NULL,
	[thanhpho] [nvarchar](10) NULL,
	[dienthoai] [nvarchar](50) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[masothue] [nvarchar](50) NULL,
	[sotaikhoannganhang] [nvarchar](50) NULL,
	[tennganhang] [nvarchar](225) NULL,
	[ghichunganhnghe] [nvarchar](225) NULL,
	[nguoidaidien] [nvarchar](225) NULL,
	[quocgia] [nvarchar](10) NULL,
	[usertao] [nvarchar](50) NULL,
	[ngaytao] [datetime] NULL,
 CONSTRAINT [PK_tbl_danhsachnhacungcap] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

----------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_dstaikhoan]    Script Date: 9/23/2017 11:22:05 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_dstaikhoan](
	[matk] [nchar](10) NULL,
	[tentk] [nchar](50) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[captk] [int] NOT NULL CONSTRAINT [DF_tbl_dstaikhoan_captk]  DEFAULT ((1)),
	[matktren] [nchar](10) NULL CONSTRAINT [DF_tbl_dstaikhoan_matktren]  DEFAULT ((0)),
	[loaitkid] [int] NULL CONSTRAINT [DF_tbl_dstaikhoan_loaitkid]  DEFAULT ((4)),
	[loaichitiet] [bit] NOT NULL CONSTRAINT [DF_tbl_dstaikhoan_loaichitiet]  DEFAULT ((0)),
	[nodk] [float] NULL CONSTRAINT [DF_tbl_dstaikhoan_nodk]  DEFAULT ((0)),
	[codk] [float] NULL CONSTRAINT [DF_tbl_dstaikhoan_codk]  DEFAULT ((0)),
 CONSTRAINT [PK_tbl_dstaikhoan] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

-------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_kho_detail_phieunhapkho]    Script Date: 9/23/2017 11:22:14 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_kho_detail_phieunhapkho](
	[sophieu] [int] NULL,
	[makhang] [nvarchar](50) NULL,
	[tenhang] [nvarchar](225) NULL,
	[donvi] [nvarchar](10) NULL,
	[soluongyeucau] [int] NULL,
	[soluongnhap] [int] NULL,
	[dongia] [float] NULL,
	[thanhtien] [float] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_tbl_kho_detail_phieunhapkho] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

-----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_kho_dichvu]    Script Date: 9/23/2017 11:22:23 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_kho_dichvu](
	[madv] [nvarchar](50) NULL,
	[tendv] [nvarchar](225) NULL,
	[mavach] [nvarchar](50) NULL,
	[donvi] [nvarchar](10) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[idmanhomsp] [nvarchar](10) NULL,
	[ghichu] [nvarchar](225) NULL,
 CONSTRAINT [PK_tbl_kho_dichvu] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_kho_head_phieunhapkho]    Script Date: 9/23/2017 11:22:33 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_kho_head_phieunhapkho](
	[ngayphieunhap] [datetime] NULL,
	[sophieu] [int] NULL,
	[nguoigiao] [nvarchar](50) NULL,
	[diachibophan] [nvarchar](225) NULL,
	[makho] [nvarchar](50) NULL,
	[hoadondikhem] [nvarchar](50) NULL,
	[notk] [nvarchar](50) NULL,
	[cotk] [nvarchar](50) NULL,
	[createby] [nvarchar](50) NULL,
	[createdate] [datetime] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_tbl_kho_head_phieunhapkho] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_kho_nhomsanpham]    Script Date: 9/23/2017 11:22:42 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_kho_nhomsanpham](
	[manhomsanpham] [nchar](10) NULL,
	[tennhomsanpham] [nvarchar](50) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_manhomsanpham] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_kho_sanpham]    Script Date: 9/23/2017 11:22:51 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_kho_sanpham](
	[masp] [nvarchar](50) NULL,
	[tensp] [nvarchar](225) NULL,
	[mavach] [nvarchar](50) NULL,
	[donvi] [nvarchar](10) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[trongluong] [float] NULL,
	[khoiluong] [float] NULL,
	[idmanhomsp] [nvarchar](10) NULL,
	[ghichu] [nvarchar](225) NULL,
 CONSTRAINT [PK_tbl_kho_sanpham] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

-----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_khohang]    Script Date: 9/23/2017 11:23:00 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_khohang](
	[tenkho] [nvarchar](50) NULL,
	[makho] [nvarchar](10) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[diachikho] [nvarchar](50) NULL,
	[ghichu] [nvarchar](50) NULL,
 CONSTRAINT [PK_tbl_khohang] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_loaitk]    Script Date: 9/23/2017 11:23:09 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_loaitk](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[name] [nchar](50) NULL,
	[idloaitk] [int] NULL,
 CONSTRAINT [PK_tbl_loaitk] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_machitiettk]    Script Date: 9/23/2017 11:23:19 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_machitiettk](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[tenchitiet] [nvarchar](50) NULL,
	[matk] [nvarchar](50) NULL,
	[machitiet] [int] NULL,
	[ghichu] [nvarchar](225) NULL,
	[nodk] [float] NULL CONSTRAINT [DF_tbl_machitiettk_nodk]  DEFAULT ((0)),
	[codk] [float] NULL CONSTRAINT [DF_tbl_machitiettk_codk]  DEFAULT ((0)),
 CONSTRAINT [PK_tbl_machitiettk] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

--------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_Socai]    Script Date: 9/23/2017 11:23:29 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_Socai](
	[Diengiai] [nchar](225) NULL,
	[Ngayghiso] [datetime] NULL,
	[Ngayctu] [datetime] NULL,
	[manghiepvu] [nvarchar](10) NULL,
	[nghiepvuso] [int] NULL,
	[username] [nvarchar](10) NULL,
	[TkNo] [nvarchar](10) NULL,
	[TkCo] [nvarchar](10) NULL,
	[MaCTietTKCo] [int] NULL,
	[MaCTietTKNo] [int] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[Kyhieuctu] [nvarchar](50) NULL,
	[Soctu] [int] NULL,
	[tenchitietCo] [nvarchar](225) NULL,
	[tenchitietNo] [nvarchar](225) NULL,
	[PsNo] [float] NULL,
	[PsCo] [float] NULL,
 CONSTRAINT [PK_Socai] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

--------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_SoQuy]    Script Date: 9/23/2017 11:23:39 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_SoQuy](
	[TKtienmat] [nvarchar](10) NULL,
	[ChitietTM] [int] NULL,
	[Ngayctu] [datetime] NOT NULL,
	[Sochungtu] [int] NOT NULL,
	[Machungtu] [nvarchar](10) NULL,
	[PsNo] [float] NULL,
	[PsCo] [float] NULL,
	[Diengiai] [nvarchar](225) NULL,
	[Chitietdoiung] [int] NULL,
	[Nguoinopnhantien] [nvarchar](100) NULL,
	[Diachinguoinhannop] [nvarchar](225) NULL,
	[Chungtugockemtheo] [int] NOT NULL,
	[Ngayghiso] [datetime] NULL,
	[Username] [nvarchar](50) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[quyenso] [nvarchar](10) NULL,
	[TKdoiung] [nvarchar](225) NULL,
	[TenchitietTM] [nvarchar](225) NULL,
 CONSTRAINT [PK_SoQuy2] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

----------------
USE [BEE]
GO

/****** Object:  Table [dbo].[tbl_Temp]    Script Date: 9/23/2017 11:23:49 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_Temp](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[Version] [int] NULL,
	[RegionCode] [nchar](225) NULL,
	[username] [nchar](225) NULL,
	[password] [nchar](225) NULL,
	[userright] [int] NULL,
	[note] [nchar](225) NULL,
	[inputcontract] [bit] NOT NULL CONSTRAINT [DF_tbl_Temp_inputcontract]  DEFAULT ((0)),
	[name] [nvarchar](50) NULL,
 CONSTRAINT [PK_temp] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

USE [BEE]
GO

/****** Object:  Table [dbo].[RPtdetaillchuyenttttiep]    Script Date: 19/12/2017 7:36:13 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RPtdetaillchuyenttttiep](
	[nn01thudthu] [float] NULL,
	[nn02chiccap] [float] NULL,
	[nn03chilaodong] [float] NULL,
	[nn05chithuetndn] [float] NULL,
	[nn06thukhac] [float] NULL,
	[nn07chikhac] [float] NULL,
	[nn20llkd] [float] NULL,
	[nn21chitsan] [float] NULL,
	[nn22thutaisan] [float] NULL,
	[nn23chichovay] [float] NULL,
	[nn25chidtdonvikhac] [float] NULL,
	[nn26thudtdonvikhac] [float] NULL,
	[nn27thulaicotuc] [float] NULL,
	[nn31thucophieu] [float] NULL,
	[nn32chitravon] [float] NULL,
	[nn33thudivay] [float] NULL,
	[nn34tragoc] [float] NULL,
	[nn35tragocthue] [float] NULL,
	[nn36tracotuc] [float] NULL,
	[nn50lltrongky] [float] NULL,
	[nn60tiendauky] [float] NULL,
	[nn61tientygia] [float] NULL,
	[nn70tiencuoiky] [float] NULL,
	[nt01thudthu] [float] NULL,
	[nt02chiccap] [float] NULL,
	[nt03chilaodong] [float] NULL,
	[nt04chilaivay] [float] NULL,
	[nt05chithuetndn] [float] NULL,
	[nt06thukhac] [float] NULL,
	[nt07chikhac] [float] NULL,
	[nt21chitsan] [float] NULL,
	[nt22thutaisan] [float] NULL,
	[nt23chichovay] [float] NULL,
	[nt24thuchovay] [float] NULL,
	[nt25chidtdonvikhac] [float] NULL,
	[nt26thudtdonvikhac] [float] NULL,
	[nt31thucophieu] [float] NULL,
	[nt32chitravon] [float] NULL,
	[nt33thudivay] [float] NULL,
	[nt34tragoc] [float] NULL,
	[nt27thulaicotuc] [float] NULL,
	[nt20llkd] [float] NULL,
	[nn24thuchovay] [float] NULL,
	[nn04chilaivay] [float] NULL,
	[nt35tragocthue] [float] NULL,
	[nt36tracotuc] [float] NULL,
	[nt50lltrongky] [float] NULL,
	[nt60tiendauky] [float] NULL,
	[nt70tiencuoiky] [float] NULL,
	[nt61tientygia] [float] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
 CONSTRAINT [PK_RPtdetaillchuyenttttiep] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

USE [BEE]
GO

/****** Object:  Table [dbo].[RPtheadLCTTTtiep]    Script Date: 19/12/2017 7:36:48 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RPtheadLCTTTtiep](
	[nam] [nvarchar](4) NULL,
	[giamdoc] [nvarchar](50) NULL,
	[ketoantruong] [nvarchar](50) NULL,
	[nguoighiso] [nvarchar](50) NULL,
	[tencongty] [nvarchar](225) NULL,
	[masothue] [nvarchar](50) NULL,
	[diachicongty] [nvarchar](225) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
	[taikhoan] [nvarchar](50) NULL,
 CONSTRAINT [PK_RPtheadLCTTTtiep] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO



USE [BEE]
GO

/****** Object:  Table [dbo].[RPtdetailCDKT200lientuc]    Script Date: 21/12/2017 11:34:30 PM ******/
DROP TABLE [dbo].[RPtdetailCDKT200lientuc]
GO

/****** Object:  Table [dbo].[RPtdetailCDKT200lientuc]    Script Date: 21/12/2017 11:34:30 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[RPtdetailCDKT200lientuc](
	[cn111tien] [float] NULL,
	[cn112tientduong] [float] NULL,
	[cn121chungkhoan] [float] NULL,
	[cn122ckduphong] [float] NULL,
	[cn123dtdenngay] [float] NULL,
	[cn131ptkhach] [float] NULL,
	[cn132tratruoc] [float] NULL,
	[cn133pthunbnganh] [float] NULL,
	[cn134pthutiendokh] [float] NULL,
	[cn135pthuchovay] [float] NULL,
	[cn136ptnganhan] [float] NULL,
	[cn137dpptnganhan] [float] NULL,
	[cn139tsthieucho] [float] NULL,
	[cn141hangton] [float] NULL,
	[cn149duphonght] [float] NULL,
	[cn151cftratruoc] [float] NULL,
	[cn152vatkhautru] [float] NULL,
	[cn153thuepthukac] [float] NULL,
	[cn154traiphieu] [float] NULL,
	[cn155tskhacnh] [float] NULL,
	[cn211ptkhach] [float] NULL,
	[cn212tratruocdh] [float] NULL,
	[cn213vonodonvi] [float] NULL,
	[cn214pthunbo] [float] NULL,
	[cn215pthuchovay] [float] NULL,
	[cn216pthukhac] [float] NULL,
	[cn219duphongpt] [float] NULL,
	[cn222tscdngia] [float] NULL,
	[cn223tskhauh] [float] NULL,
	[cn225tscdthung] [float] NULL,
	[cn226tscdthuekha] [float] NULL,
	[cn228tscdvohnggia] [float] NULL,
	[cn229tscdvhkhauh] [float] NULL,
	[cn231bdsngia] [float] NULL,
	[cn232bdshaomon] [float] NULL,
	[cn241cfkddd] [float] NULL,
	[cn242cfxddd] [float] NULL,
	[cn251dtuctycon] [float] NULL,
	[cn252dtuctylienket] [float] NULL,
	[cn253dtukhac] [float] NULL,
	[cn254duphongdt] [float] NULL,
	[cn255dtudaohan] [float] NULL,
	[cn261cftratruocdn] [float] NULL,
	[cn262thuetndnhl] [float] NULL,
	[cn263vtuthietbidn] [float] NULL,
	[cn268tskhac] [float] NULL,
	[cn311ptnbannh] [float] NULL,
	[cn312ngmuatratr] [float] NULL,
	[cn313thuephainop] [float] NULL,
	[cn314ptracnhan] [float] NULL,
	[cn315cphiptranh] [float] NULL,
	[cn316cfptranbonh] [float] NULL,
	[cn317ptrtheoluong] [float] NULL,
	[cn318pthuchunhan] [float] NULL,
	[cn319ptranhan] [float] NULL,
	[cn320vaynotcnhan] [float] NULL,
	[cn321duphptranh] [float] NULL,
	[cn322quykhen] [float] NULL,
	[cn323quygia] [float] NULL,
	[cn324bantraiphieu] [float] NULL,
	[cn331nodnngban] [float] NULL,
	[cn332ngmuatratdn] [float] NULL,
	[cn333cphiphaitra] [float] NULL,
	[cn334ptranbvevon] [float] NULL,
	[cn335ptranbdaihan] [float] NULL,
	[cn336dthuchthdn] [float] NULL,
	[cn337ptradnkhac] [float] NULL,
	[cn338vaynodn] [float] NULL,
	[cn339traiphieu] [float] NULL,
	[cn340cophieu] [float] NULL,
	[cn341tnhoanlai] [float] NULL,
	[cn342duphongdn] [float] NULL,
	[cn343quykhoahoc] [float] NULL,
	[cn411vongopcsh] [float] NULL,
	[cn411bcpudai] [float] NULL,
	[cn412thangduvon] [float] NULL,
	[cn413traiphieu] [float] NULL,
	[cn414voncshkhac] [float] NULL,
	[cn415cphieuquy] [float] NULL,
	[cn416chenhlechts] [float] NULL,
	[cn417tygia] [float] NULL,
	[cn418dautuptrien] [float] NULL,
	[cn419quyxxdn] [float] NULL,
	[cn420quykhacsh] [float] NULL,
	[cn421lnsauthue] [float] NULL,
	[cn421alnkytruoc] [float] NULL,
	[cn421blnkynay] [float] NULL,
	[cn422vonxdcb] [float] NULL,
	[cn431nkinhphi] [float] NULL,
	[cn432kpthanhtscd] [float] NULL,
	[cn411acophieupt] [float] NULL,


	[dn111tien] [float] NULL,
	[dn112tientduong] [float] NULL,
	[dn121chungkhoan] [float] NULL,
	[dn122ckduphong] [float] NULL,
	[dn123dtdenngay] [float] NULL,
	[dn131ptkhach] [float] NULL,
	[dn132tratruoc] [float] NULL,
	[dn133pthunbnganh] [float] NULL,
	[dn134pthutiendokh] [float] NULL,
	[dn135pthuchovay] [float] NULL,
	[dn136ptnganhan] [float] NULL,
	[dn137dpptnganhan] [float] NULL,
	[dn139tsthieucho] [float] NULL,
	[dn141hangton] [float] NULL,
	[dn149duphonght] [float] NULL,
	[dn151cftratruoc] [float] NULL,
	[dn152vatkhautru] [float] NULL,
	[dn153thuepthukac] [float] NULL,
	[dn154traiphieu] [float] NULL,
	[dn155tskhacnh] [float] NULL,
	[dn211ptkhach] [float] NULL,
	[dn212tratruocdh] [float] NULL,
	[dn213vonodonvi] [float] NULL,
	[dn214pthunbo] [float] NULL,
	[dn215pthuchovay] [float] NULL,
	[dn216pthukhac] [float] NULL,
	[dn219duphongpt] [float] NULL,
	[dn222tscdngia] [float] NULL,
	[dn223tskhauh] [float] NULL,
	[dn225tscdthung] [float] NULL,
	[dn226tscdthuekha] [float] NULL,
	[dn228tscdvohnggia] [float] NULL,
	[dn229tscdvhkhauh] [float] NULL,
	[dn231bdsngia] [float] NULL,
	[dn232bdshaomon] [float] NULL,
	[dn241cfkddd] [float] NULL,
	[dn242cfxddd] [float] NULL,
	[dn251dtuctycon] [float] NULL,
	[dn252dtuctylienket] [float] NULL,
	[dn253dtukhac] [float] NULL,
	[dn254duphongdt] [float] NULL,
	[dn255dtudaohan] [float] NULL,
	[dn261cftratruocdn] [float] NULL,
	[dn262thuetndnhl] [float] NULL,
	[dn263vtuthietbidn] [float] NULL,
	[dn268tskhac] [float] NULL,
	[dn311ptnbannh] [float] NULL,
	[dn312ngmuatratr] [float] NULL,
	[dn313thuephainop] [float] NULL,
	[dn314ptracnhan] [float] NULL,
	[dn315cphiptranh] [float] NULL,
	[dn316cfptranbonh] [float] NULL,
	[dn317ptrtheoluong] [float] NULL,
	[dn318pthuchunhan] [float] NULL,
	[dn319ptranhan] [float] NULL,
	[dn320vaynotcnhan] [float] NULL,
	[dn321duphptranh] [float] NULL,
	[dn322quykhen] [float] NULL,
	[dn323quygia] [float] NULL,
	[dn324bantraiphieu] [float] NULL,
	[dn331nodnngban] [float] NULL,
	[dn332ngmuatratdn] [float] NULL,
	[dn333cphiphaitra] [float] NULL,
	[dn334ptranbvevon] [float] NULL,
	[dn335ptranbdaihan] [float] NULL,
	[dn336dthuchthdn] [float] NULL,
	[dn337ptradnkhac] [float] NULL,
	[dn338vaynodn] [float] NULL,
	[dn339traiphieu] [float] NULL,
	[dn340cophieu] [float] NULL,
	[dn341tnhoanlai] [float] NULL,
	[dn342duphongdn] [float] NULL,
	[dn343quykhoahoc] [float] NULL,
	[dn411vongopcsh] [float] NULL,
	[dn411bcpudai] [float] NULL,
	[dn412thangduvon] [float] NULL,
	[dn413traiphieu] [float] NULL,
	[dn414voncshkhac] [float] NULL,
	[dn415cphieuquy] [float] NULL,
	[dn416chenhlechts] [float] NULL,
	[dn417tygia] [float] NULL,
	[dn418dautuptrien] [float] NULL,
	[dn419quyxxdn] [float] NULL,
	[dn420quykhacsh] [float] NULL,
	[dn421lnsauthue] [float] NULL,
	[dn421alnkytruoc] [float] NULL,
	[dn421blnkynay] [float] NULL,
	[dn422vonxdcb] [float] NULL,
	[dn431nkinhphi] [float] NULL,
	[dn432kpthanhtscd] [float] NULL,
	[dn411acophieupt] [float] NULL,


	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
	
 CONSTRAINT [PK_RPtdetailCDKT200lientuc] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

USE [BEE]
GO
/****** Object:  StoredProcedure [dbo].[calulationCDKT200loai1]    Script Date: 22/12/2017 11:15:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




ALTER procedure  [dbo].[calulationCDKT200loai1]
( 
@username nvarchar (225) ,
 @yearchon INT 


)
 
as


begin


		IF OBJECT_ID(N'tempdb..#TempResults', N'U') IS NOT NULL 
        DROP TABLE #TempResults;

		CREATE TABLE #TempResults
			(
		                       matk Nvarchar(10),
								loainganhan bit, 
                             	machitiet int,
                                tPSNo float,
                                tPSCo float,
								tPsNotruPSco float,
							
			)



		begin
        insert into #TempResults (matk,loainganhan, machitiet, tPSCo, tPSNo )
		SELECT tbl_Socai.TkCo,tbl_Socai.[nganhan], ISNULL(tbl_Socai.MaCTietTKCo, -1), SUM(tbl_Socai.PsCo),'0'
		 FROM  tbl_Socai
		 WHERE   year( tbl_Socai.Ngayctu)= @yearchon
	     GROUP BY tbl_Socai.TkCo, tbl_Socai.MaCTietTKCo, tbl_Socai.[nganhan]
		end

		
		begin
        insert into #TempResults (matk,loainganhan, machitiet, tPSNo, tPSCo )
		SELECT tbl_Socai.TkNo,tbl_Socai.[nganhan], ISNULL(tbl_Socai.MaCTietTKNo,-1), SUM(tbl_Socai.PsNo),'0'
		 FROM  tbl_Socai
		 WHERE   year( tbl_Socai.Ngayctu)= @yearchon
	     GROUP BY tbl_Socai.TkNo, tbl_Socai.MaCTietTKNo, tbl_Socai.[nganhan]
		end
		

		IF OBJECT_ID(N'tempdb..#TempResults2', N'U') IS NOT NULL 
        DROP TABLE #TempResults2;

		CREATE TABLE #TempResults2
			(
		                       matk Nvarchar(10),
								loainganhan bit, 
                             	machitiet int,
                                tPSNo float,
                                tPSCo float,
								tPsNotruPSco float,
							
			)


	   begin
        insert into #TempResults2 (matk,loainganhan, machitiet, tPSNo, tPSCo, tPsNotruPSco)
		SELECT #TempResults.matk,#TempResults.loainganhan, #TempResults.machitiet, SUM(#TempResults.tPSNo),SUM(#TempResults.tPSCo) , SUM(#TempResults.tPSNo)- SUM(#TempResults.tPSCo)
		 FROM  #TempResults
	--	 WHERE   year( tbl_Socai.Ngayctu)= @yearchon
	     GROUP BY #TempResults.matk , #TempResults.machitiet ,#TempResults.loainganhan
		end






	BEGIN  -- udate baocaos ke toan

				begin
				delete RPtdetailCDKT200lientuc
				where RPtdetailCDKT200lientuc.username = @username

				end
				   
    END
   
    begin
        insert into RPtdetailCDKT200lientuc (username )
		values (@username )
		 --FROM RPtdetailKQKD200 
	--   where tbl_Socai.Ngayctu >=@fromdate and  tbl_Socai.Ngayctu <= @todate
	--   group by  tbl_Socai.TkNo --tbl_Socai.TkCo,
		end


BEGIN
  UPDATE  RPtdetailCDKT200lientuc
         SET 
		
	RPtdetailCDKT200lientuc.cn111tien = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '111' 
						 or left(#TempResults2.matk,3) =  '112' 
						 	 or left(#TempResults2.matk,3) =  '113') )  ,0),

RPtdetailCDKT200lientuc.cn112tientduong = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1281' 
						 or left(#TempResults2.matk,4) =  '1288' ) and
							#TempResults2.loainganhan ='1')  ,0),

RPtdetailCDKT200lientuc.cn121chungkhoan = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '121' 
						 ) and
							#TempResults2.loainganhan ='1')  ,0)	,												


RPtdetailCDKT200lientuc.cn122ckduphong = - isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2291' 
						 ) and
							#TempResults2.loainganhan ='1')  ,0)	,	
																		
RPtdetailCDKT200lientuc.cn123dtdenngay = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1281' 
						or left(#TempResults2.matk,4) =  '1282' 
							or left(#TempResults2.matk,4) =  '1288' 
						 ) )  ,0)													

							- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1281' 
						 or left(#TempResults2.matk,4) =  '1288' ) and
							#TempResults2.loainganhan ='1')  ,0) ,


RPtdetailCDKT200lientuc.cn131ptkhach = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '131' 
						and #TempResults2.tPsNotruPSco > 0
						
						 ) and 
							#TempResults2.loainganhan ='1')  ,0)	,	


RPtdetailCDKT200lientuc.cn132tratruoc = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '331' 
						and #TempResults2.tPsNotruPSco > 0
						
						 ) and 
							#TempResults2.loainganhan ='1')  ,0)	,	


RPtdetailCDKT200lientuc.cn133pthunbnganh = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1362' 
						 or left(#TempResults2.matk,4) =  '1363' 
						  or left(#TempResults2.matk,4) =  '1368' 
						  )
						and #TempResults2.tPsNotruPSco > 0
						
						  and 
							#TempResults2.loainganhan ='1')  ,0)	,	

RPtdetailCDKT200lientuc.cn134pthutiendokh = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '337' 
						
						  )
						and #TempResults2.tPsNotruPSco > 0
						
						)  ,0)	,	

RPtdetailCDKT200lientuc.cn135pthuchovay = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1283' 
						
						  )
						and #TempResults2.tPsNotruPSco > 0
						
						  and 
							#TempResults2.loainganhan ='1')  ,0)	,	


RPtdetailCDKT200lientuc.cn136ptnganhan = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1385' 
					or	left(#TempResults2.matk,4) =  '1388' 
					or	left(#TempResults2.matk,3) =  '334' 
						or	left(#TempResults2.matk,3) =  '338' 
							or	left(#TempResults2.matk,3) =  '141' 
								or	left(#TempResults2.matk,3) =  '244' 
						  )
						and #TempResults2.tPsNotruPSco > 0
						
						  and 
							#TempResults2.loainganhan ='1')  ,0)		,

	RPtdetailCDKT200lientuc.cn137dpptnganhan = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2293' 
						
						  )

						and #TempResults2.tPsNotruPSco < 0
							
						  and 
							#TempResults2.loainganhan ='1')  ,0)	,


	RPtdetailCDKT200lientuc.cn139tsthieucho = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1381' 
						
						  )

						and #TempResults2.tPsNotruPSco < 0
						
						)  ,0)	,


	RPtdetailCDKT200lientuc.cn141hangton = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '151' 
						 or left(#TempResults2.matk,3) =  '152' 
							 or left(#TempResults2.matk,3) =  '153' 
							 	 or left(#TempResults2.matk,3) =  '154' 
								 	 or left(#TempResults2.matk,3) =  '155' 
									 	 or left(#TempResults2.matk,3) =  '156' 
										  or left(#TempResults2.matk,3) =  '157' 
						  )

						and #TempResults2.tPsNotruPSco > 0
						
						)  ,0)	,						
								
	RPtdetailCDKT200lientuc.cn151cftratruoc = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '242' 
					
						  )

						and #TempResults2.tPsNotruPSco > 0
						
						)  ,0)	,
						
	RPtdetailCDKT200lientuc.cn152vatkhautru = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '133' 
					
						  )

						and #TempResults2.tPsNotruPSco > 0
						
						)  ,0)	,
						
	RPtdetailCDKT200lientuc.cn153thuepthukac = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '333' 
					
						  )

						and #TempResults2.tPsNotruPSco > 0
							and #TempResults2.machitiet is not null 
						)  ,0)	,								
						
	RPtdetailCDKT200lientuc.cn154traiphieu = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '171' 
					
						  )

						and #TempResults2.tPsNotruPSco > 0
					
						)  ,0)	,	
													
	RPtdetailCDKT200lientuc.cn155tskhacnh = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2288' 
					
						  )

						and #TempResults2.tPsNotruPSco > 0
						
							  and 
							#TempResults2.loainganhan ='1'
						)  ,0)		,
						
RPtdetailCDKT200lientuc.cn211ptkhach = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '131' 
						and #TempResults2.tPsNotruPSco > 0
							
						 ) and 
							#TempResults2.loainganhan ='0')  ,0)	,	
						
						
RPtdetailCDKT200lientuC.cn212tratruocdh = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '331' 
						and #TempResults2.tPsNotruPSco > 0
							
						 ) and 
							#TempResults2.loainganhan ='0')  ,0)	,	
												
RPtdetailCDKT200lientuc.cn213vonodonvi = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1361' 
						and #TempResults2.tPsNotruPSco > 0
							
						 ) )  ,0)	,	
												
											
RPtdetailCDKT200lientuc.cn214pthunbo = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1362' 
						 or left(#TempResults2.matk,4) =  '1363' 
						  or left(#TempResults2.matk,4) =  '1368' 
						and #TempResults2.tPsNotruPSco > 0
							
						 ) and 
							#TempResults2.loainganhan ='0')  ,0)	,	
							
							
RPtdetailCDKT200lientuc.cn215pthuchovay = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1283' 
						
						and #TempResults2.tPsNotruPSco > 0
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,	
														
					
RPtdetailCDKT200lientuc.cn216pthukhac = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1285' 
						or left(#TempResults2.matk,4) =  '1288' 
					or	left(#TempResults2.matk,3) =  '334' 
						or left(#TempResults2.matk,3) =  '338' 
							or left(#TempResults2.matk,3) =  '141' 
								or left(#TempResults2.matk,3) =  '244' 
						and #TempResults2.tPsNotruPSco > 0
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,	
														
							
RPtdetailCDKT200lientuc.cn219duphongpt = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2293' 
						
						and #TempResults2.tPsNotruPSco > 0
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0) 	,
							
							
							
RPtdetailCDKT200lientuc.cn222tscdngia = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '211' 
						
						and #TempResults2.tPsNotruPSco > 0
							
						 ))  ,0) 		,
						 
							
RPtdetailCDKT200lientuc.cn223tskhauh = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2141' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0) 	,

RPtdetailCDKT200lientuc.cn225tscdthung = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '212' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)	,						
							
RPtdetailCDKT200lientuc.cn226tscdthuekha = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2142' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)			,
						 
RPtdetailCDKT200lientuc.cn228tscdvohnggia = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '213' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)	,					 				
			
RPtdetailCDKT200lientuc.cn229tscdvhkhauh = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2143' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	,					 				
						
RPtdetailCDKT200lientuc.cn231bdsngia = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '217' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)		,
						
RPtdetailCDKT200lientuc.cn232bdshaomon = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2147' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)		,

RPtdetailCDKT200lientuc.cn241cfkddd = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2294' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,
							
RPtdetailCDKT200lientuc.cn242cfxddd = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '241' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)	,
						 
RPtdetailCDKT200lientuc.cn251dtuctycon = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '221' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)	,
						 
RPtdetailCDKT200lientuc.cn252dtuctylienket = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '222' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)		,
						 
RPtdetailCDKT200lientuc.cn253dtukhac = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2281' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)			,
						 
RPtdetailCDKT200lientuc.cn254duphongdt =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2292' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	,
						 
RPtdetailCDKT200lientuc.cn255dtudaohan = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1281' 
					or	left(#TempResults2.matk,4) =  '1282' 
						or	left(#TempResults2.matk,4) =  '1288' 
						

						and #TempResults2.tPsNotruPSco >0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,

						
	RPtdetailCDKT200lientuc.cn261cftratruocdn = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '242' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)	,
							
	RPtdetailCDKT200lientuc.cn262thuetndnhl = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '243' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)	,
						 
	RPtdetailCDKT200lientuc.cn263vtuthietbidn = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '1534' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)							 						
													 						 				 					 														 						 				 				
						+
						isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2294' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)		,
							
RPtdetailCDKT200lientuc.cn268tskhac = isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '2288' 
						
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)	,							
														 														 						 				 				
	
RPtdetailCDKT200lientuc.cn311ptnbannh = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '311' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)	,

RPtdetailCDKT200lientuc.cn312ngmuatratr = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '131' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)	,
							
							
RPtdetailCDKT200lientuc.cn313thuephainop =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '333' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)	,
							
							
RPtdetailCDKT200lientuc.cn314ptracnhan = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '334' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)	,

					
RPtdetailCDKT200lientuc.cn315cphiptranh = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '335' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)		,
							
							
												
RPtdetailCDKT200lientuc.cn316cfptranbonh = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '3362' 
					or	left(#TempResults2.matk,4) =  '3363' 
							or	left(#TempResults2.matk,4) =  '3368' )

						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)		,														
														 														
														 																						
RPtdetailCDKT200lientuc.cn317ptrtheoluong = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,3) =  '337' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)		,														 														
														 																		
														 																						
RPtdetailCDKT200lientuc.cn318pthuchunhan = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where (left(#TempResults2.matk,4) =  '3387 ' 
						
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)	,															 														
														 																		
																			 																						
RPtdetailCDKT200lientuC.cn319ptranhan = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '338' 
					or	left(#TempResults2.matk,3) =  '138'
							or	left(#TempResults2.matk,3) =  '344'
					
					 )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)	,


																										 																						
RPtdetailCDKT200lientuC.cn320vaynotcnhan =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '341' 
					or	left(#TempResults2.matk,5) =  '34311' )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	,


																										 																						
RPtdetailCDKT200lientuc.cn321duphptranh = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '352' 
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='1')  ,0)	,



																										 																						
RPtdetailCDKT200lientuc.cn322quykhen = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '353' 
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	,

							
				
																										 																						
RPtdetailCDKT200lientuc.cn323quygia = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '357' 
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0  ),

			
																										 																						
RPtdetailCDKT200lientuc.cn324bantraiphieu =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '171' 
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0 )	,

RPtdetailCDKT200lientuc.cn331nodnngban = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '331' 
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,

		
RPtdetailCDKT200lientuc.cn332ngmuatratdn = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '131' 
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,  


RPtdetailCDKT200lientuc.cn333cphiphaitra = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '335' 
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,  


		
RPtdetailCDKT200lientuc.cn334ptranbvevon =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '3361' 
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,  
																
							
		
RPtdetailCDKT200lientuc.cn335ptranbdaihan =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '3362' 
						 or left(#TempResults2.matk,4) =  '3363' 
						or left(#TempResults2.matk,4) =  '3368' 
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,  
									
				
		
RPtdetailCDKT200lientuc.cn336dthuchthdn =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '3387' 
						
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	,  
									

			
RPtdetailCDKT200lientuc.cn337ptradnkhac = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '338' 
				or		left(#TempResults2.matk,3) =  '334' 
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	  ,
				--	Du C chi ti?t TK 341 v
--Du C TK 34311 tr? (-) du N? TK
-- 34312 c?ng (+) du C TK 34313.			
			
RPtdetailCDKT200lientuc.cn338vaynodn = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '341' 
						
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	
					+		isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,5) =  '34311' 
						
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)  
					-		isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,5) =  '34312' 
						
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)
					+	isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,5) =  '34313' 
						
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)  ,						
							
	
			
RPtdetailCDKT200lientuc.cn339traiphieu =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '34312' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	  ,						
																					 											
	
RPtdetailCDKT200lientuc.cn340cophieu = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '41112' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	  ,
							
							
				
RPtdetailCDKT200lientuc.cn341tnhoanlai = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '347' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	  ,						
																					 											
	
RPtdetailCDKT200lientuc.cn342duphongdn =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '352' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 )and 
							#TempResults2.loainganhan ='0')  ,0)	  ,						
													
	
RPtdetailCDKT200lientuc.cn343quykhoahoc =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '356' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	 ,
						 
						 
						 								
	
RPtdetailCDKT200lientuc.cn411vongopcsh = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '411' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	  		,		
		 								
	
RPtdetailCDKT200lientuc.cn411acophieupt =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,5) =  '41111' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	  		,

RPtdetailCDKT200lientuc.cn411bcpudai =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,5) =  '41112' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	  		,
						 

RPtdetailCDKT200lientuc.cn412thangduvon = - isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '4112' 
			
			
					     )
						and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)		,					 				 		
											
											
			
RPtdetailCDKT200lientuc.cn413traiphieu = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '4113' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)			,
						 
						 
RPtdetailCDKT200lientuc.cn414voncshkhac = - isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '4118' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	,
						 

RPtdetailCDKT200lientuc.cn415cphieuquy =  isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '419' 
			
			
					     )
						and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)			,
						 


RPtdetailCDKT200lientuc.cn416chenhlechts =  isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '416' 
			
			
					     )
					--	and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	,
						 


RPtdetailCDKT200lientuc.cn417tygia =-  isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '413' 
			
			
					     )
					--	and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	,
						 
						 

RPtdetailCDKT200lientuc.cn418dautuptrien =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '414' 
			
			
					     )
			         	and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	,
						 

RPtdetailCDKT200lientuc.cn419quyxxdn =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '417' 
			
			
					     )
			         	and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)		,				 						 									
														 									
																 							
			
RPtdetailCDKT200lientuc.cn420quykhacsh = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '418' 
			
			
					     )
			         	and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)		,
						 
						 									 							
			
RPtdetailCDKT200lientuc.cn421lnsauthue = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '421' 
			
			
					     )
			        -- 	and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)			,
						 
						 
						  									 							
			
RPtdetailCDKT200lientuc.cn421alnkytruoc =- isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '4211' 
			
			
					     )
			     --   	and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)		,
						 
						 									 							
			
RPtdetailCDKT200lientuc.cn421blnkynay = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,4) =  '4212' 
			
			
					     )
			        --	and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)		,
						 
						 								 							
			
RPtdetailCDKT200lientuc.cn422vonxdcb = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '441' 
			
			
					     )
			       	and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)		,
						 
						 
RPtdetailCDKT200lientuc.cn431nkinhphi = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '461' 
			
			
					     )
			       	and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	
						 -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '161' 
			
			
					     )
			       	and #TempResults2.tPsNotruPSco >0 
							
						 ))  ,0)	,
						 
						 
		
RPtdetailCDKT200lientuc.cn432kpthanhtscd = -isnull( (select sum(#TempResults2.tPsNotruPSco) from #TempResults2 
                         where ((left(#TempResults2.matk,3) =  '466' 
			
			
					     )
			       	and #TempResults2.tPsNotruPSco <0 
							
						 ))  ,0)	,					 								 						 									
													 						 									
																					 									
	RPtdetailCDKT200lientuc.dn111tien = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 
						 
						 and CDKT200.Machitieu= 111
						 
						           )  ,0)	,
								   
								   
								   																				 									
	RPtdetailCDKT200lientuc.dn112tientduong = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 112
						 
						           )  ,0)	,
							   																				 									
	RPtdetailCDKT200lientuc.dn121chungkhoan = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 121
						 
						           )  ,0)		,								   								
																				
RPtdetailCDKT200lientuc.dn122ckduphong = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 122
						 
						           )  ,0)	,																					 				
																				
RPtdetailCDKT200lientuc.dn123dtdenngay = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 123
						 
						           )  ,0)	,
																				
RPtdetailCDKT200lientuc.dn131ptkhach = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 131
						 
						           )  ,0)	,	
RPtdetailCDKT200lientuc.dn132tratruoc = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 132
						 
						           )  ,0)	,	
RPtdetailCDKT200lientuc.dn133pthunbnganh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 133
						 
						           )  ,0)	,									   								   								   																					 				
RPtdetailCDKT200lientuc.dn134pthutiendokh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 134
						 
						           )  ,0)	,	
RPtdetailCDKT200lientuc.dn135pthuchovay = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 135
						 
						           )  ,0)	,	
RPtdetailCDKT200lientuc.dn136ptnganhan = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 136
						 
						           )  ,0)	,		
RPtdetailCDKT200lientuc.dn137dpptnganhan = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 137
						 
						           )  ,0)	,	
RPtdetailCDKT200lientuc.dn139tsthieucho = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 139
						 
						           )  ,0)	,	
								   
RPtdetailCDKT200lientuc.dn141hangton = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 141
						 
						           )  ,0)	,	

RPtdetailCDKT200lientuc.dn149duphonght = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 131
						 
						           )  ,0)	,
								   

RPtdetailCDKT200lientuc.dn151cftratruoc = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 151
						 
						           )  ,0)	,

RPtdetailCDKT200lientuc.dn152vatkhautru = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 152
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn153thuepthukac = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 153
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn154traiphieu = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 154
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn155tskhacnh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 155
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn211ptkhach = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 211
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn212tratruocdh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 212
						 
						           )  ,0),

RPtdetailCDKT200lientuc.dn213vonodonvi = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 213
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn214pthunbo = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 214
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn215pthuchovay = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 215
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn216pthukhac = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 216
						 
						           )  ,0)	,

RPtdetailCDKT200lientuc.dn219duphongpt = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 219
						 
						           )  ,0)		,
								   


RPtdetailCDKT200lientuc.dn222tscdngia = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 222
						 
						           )  ,0)		,
								
RPtdetailCDKT200lientuc.dn223tskhauh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 223
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn225tscdthung = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 225
						 
						           )  ,0)		,
								 
RPtdetailCDKT200lientuc.dn226tscdthuekha = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 226
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn228tscdvohnggia = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 228
						 
						           )  ,0)		,
								   
								   
RPtdetailCDKT200lientuc.dn229tscdvhkhauh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 229
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn231bdsngia = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 231
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn232bdshaomon = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 232
						 
						           )  ,0)		,
								   
								   
RPtdetailCDKT200lientuc.dn241cfkddd = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 241
						 
						           )  ,0)		,
								   

RPtdetailCDKT200lientuc.dn242cfxddd = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 242
						 
						           )  ,0)		,
								   
								   
RPtdetailCDKT200lientuc.dn251dtuctycon = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 251
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn252dtuctylienket = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 252
						 
						           )  ,0)		,
								   
								   
RPtdetailCDKT200lientuc.dn253dtukhac = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 253
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn254duphongdt = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 254
						 
						           )  ,0)		,
								   

RPtdetailCDKT200lientuc.dn255dtudaohan = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 255
						 
						           )  ,0)		,
								   
								   
RPtdetailCDKT200lientuc.dn261cftratruocdn = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 261
						 
						           )  ,0)		,
								   
								   
RPtdetailCDKT200lientuc.dn262thuetndnhl = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 262
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn263vtuthietbidn = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 263
						 
						           )  ,0)		,
								   
								   
RPtdetailCDKT200lientuc.dn268tskhac = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 268
						 
						           )  ,0)		,
								 

RPtdetailCDKT200lientuc.dn311ptnbannh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 311
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn312ngmuatratr = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 312
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn313thuephainop = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 313
						 
						           )  ,0)	,

RPtdetailCDKT200lientuc.dn314ptracnhan = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 314
						 
						           )  ,0)	,

RPtdetailCDKT200lientuc.dn315cphiptranh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 315
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn316cfptranbonh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 316
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn317ptrtheoluong = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 317
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn318pthuchunhan = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 318
						 
						           )  ,0)	,

RPtdetailCDKT200lientuc.dn319ptranhan = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 319
						 
						           )  ,0)		,


								   
RPtdetailCDKT200lientuc.dn320vaynotcnhan = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 320
						 
						           )  ,0)		,


RPtdetailCDKT200lientuc.dn321duphptranh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 321
						 
						           )  ,0)		,

								   
RPtdetailCDKT200lientuc.dn322quykhen = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 322
						 
						           )  ,0)		,

								   
RPtdetailCDKT200lientuc.dn323quygia = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 323
						 
						           )  ,0)		,

								   
RPtdetailCDKT200lientuc.dn324bantraiphieu = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 324
						 
						           )  ,0)		,


RPtdetailCDKT200lientuc.dn331nodnngban = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 331
						 
						           )  ,0)		,


RPtdetailCDKT200lientuc.dn332ngmuatratdn = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 332
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn333cphiphaitra = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 333
						 
						           )  ,0)		,

								   
RPtdetailCDKT200lientuc.dn334ptranbvevon = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 334
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn335ptranbdaihan = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 335
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn336dthuchthdn = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 336
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn337ptradnkhac = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 337
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn338vaynodn = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 338
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn339traiphieu = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 339
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn340cophieu = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 340
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn341tnhoanlai = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 341
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn342duphongdn = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 342
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn343quykhoahoc = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 343
						 
						           )  ,0)		,
								   


RPtdetailCDKT200lientuc.dn411acophieupt = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 4111
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn411bcpudai = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 4112
						 
						           )  ,0)	,
								   
RPtdetailCDKT200lientuc.dn411vongopcsh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 411
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn412thangduvon = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 412
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn413traiphieu = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 413
						 
						           )  ,0)		,

RPtdetailCDKT200lientuc.dn414voncshkhac = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 414
						 
						           )  ,0)	,

RPtdetailCDKT200lientuc.dn415cphieuquy = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 415
						 
						           )  ,0)			,
								   
RPtdetailCDKT200lientuc.dn416chenhlechts = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 416
						 
						           )  ,0)		,
								   
RPtdetailCDKT200lientuc.dn417tygia = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 417
						 
						           )  ,0)			,

RPtdetailCDKT200lientuc.dn418dautuptrien = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 418
						 
						           )  ,0)				,

RPtdetailCDKT200lientuc.dn419quyxxdn = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 419
						 
						           )  ,0),								   						   	

RPtdetailCDKT200lientuc.dn420quykhacsh = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 420
						 
						           )  ,0)	,

RPtdetailCDKT200lientuc.dn421alnkytruoc = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 4211
						 
						           )  ,0)			,								   	
								   
RPtdetailCDKT200lientuc.dn421blnkynay = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 4212
						 
						           )  ,0)			,
								   
RPtdetailCDKT200lientuc.dn421lnsauthue = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 415
						 
						           )  ,0)			,
								   
RPtdetailCDKT200lientuc.dn422vonxdcb = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 422
						 
						           )  ,0)			,
								   
RPtdetailCDKT200lientuc.dn431nkinhphi = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 431
						 
						           )  ,0)			,
								   
RPtdetailCDKT200lientuc.dn432kpthanhtscd = 	isnull( (select sum(CDKT200.Sotien) from CDKT200 
                         where    CDKT200.nam =@yearchon
						 			 
						 and CDKT200.Machitieu= 432
						 
						           )  ,0)								   	
								   													   	
								   													   	
								   									   		
								   									   										   										   									   									   									   											   									   									   									   									   									   										   									   								   								   								   							   								   																																																 																																	
																									 
     from RPtdetailCDKT200lientuc
	
	where RPtdetailCDKT200lientuc.username = @username
		

      end



		IF OBJECT_ID(N'tempdb..#TempResults', N'U') IS NOT NULL 
        DROP TABLE #TempResults;

		
		IF OBJECT_ID(N'tempdb..#TempResults2', N'U') IS NOT NULL 
        DROP TABLE #TempResults2;


	END

	

-----------------------
USE [BEE]
GO

/****** Object:  Table [dbo].[LTTT200Dauky]    Script Date: 22/12/2017 5:36:40 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[LTTT200Dauky](
	[nam] [int] NULL,
	[Machitieu] [int] NULL,
	[Tenchitieu] [nvarchar](225) NULL,
	[Cachghi] [nvarchar](225) NULL,
	[Sotien] [float] NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
	[username] [nvarchar](50) NULL,
 CONSTRAINT [PK_LTTT200Dauky] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

------------lcttien progarme

USE [BEE]
GO
/****** Object:  StoredProcedure [dbo].[calulationluuchuyentiente200]    Script Date: 22/12/2017 7:05:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




ALTER procedure  [dbo].[calulationluuchuyentiente200]
( 
@username nvarchar (225) ,
 @yearchon INT 


)
 
as


begin


		IF OBJECT_ID(N'tempdb..#Tempthu', N'U') IS NOT NULL 
        DROP TABLE #Tempthu;

		
		CREATE TABLE #Tempthu
			(
		                        matkDU Nvarchar(10),
								
                             	machitiet int,
                                tPSNo float,
                          	stat int ,
							
			)

IF OBJECT_ID(N'tempdb..#Tempchi', N'U') IS NOT NULL 
        DROP TABLE #Tempchi;

		
		CREATE TABLE #Tempchi
			(
		                       matkDU Nvarchar(10),
								
                             	machitiet int,
                              
                                tPSCo float,
						stat int ,
							
			)


		begin
        insert into #Tempthu (matkDU, machitiet, tPSNo ,stat)
		SELECT tbl_Socai.TkCo, ISNULL(tbl_Socai.MaCTietTKCo, -1), SUM(tbl_Socai.PsCo),'0'
		 FROM  tbl_Socai
		 WHERE   year( tbl_Socai.Ngayctu)= @yearchon
		       and (left(tbl_Socai.TkNo,3) =  '111'  
					or  left(tbl_Socai.TkNo,3)=  '112' 
					or  left(tbl_Socai.TkNo,3)=  '113' 	  
						   )

	     GROUP BY tbl_Socai.TkCo, tbl_Socai.MaCTietTKCo
		end

		begin

        insert into #Tempchi (matkDU, machitiet, tPSCo ,stat)
		SELECT tbl_Socai.TkNo, ISNULL(tbl_Socai.MaCTietTKNo, -1),- SUM(tbl_Socai.PsCo),'0'
		 FROM  tbl_Socai
		 WHERE   year( tbl_Socai.Ngayctu)= @yearchon
		       and (left(tbl_Socai.TkCo,3) =  '111'  
					or  left(tbl_Socai.TkCo,3)=  '112' 
					or  left(tbl_Socai.TkCo,3)=  '113' 	  
						   )

	     GROUP BY tbl_Socai.TkNo, tbl_Socai.MaCTietTKNo
		end


		 
	

		begin
		delete RPtdetaillchuyenttttiep
		where RPtdetaillchuyenttttiep.username = @username

		end

       begin
        insert into RPtdetaillchuyenttttiep (username,nn01thudthu,nn02chiccap )
		values (@username, '0','0' )
		
		end

	
	


begin -- loai 1
 UPDATE  #Tempthu
         SET 
#Tempthu.stat ='1'
  where (left(#Tempthu.matkDU,3) =  '511'  
						  or  left(#Tempthu.matkDU,4)=  '3331'  
						  	  or  left(#Tempthu.matkDU,3)=  '131'  
							  	  or  left(#Tempthu.matkDU,3)=  '515'  
	  or  left(#Tempthu.matkDU,3)=  '121'  )


end


begin -- loai 2
 UPDATE  #Tempchi  
         SET 
#Tempchi.stat ='2'
  where (left(#Tempchi.matkDU,3) =  '331'  
					or  left(#Tempchi.matkDU,3)=  '151'  
					or  left(#Tempchi.matkDU,3)=  '152'  
					or  left(#Tempchi.matkDU,3)=  '153'  
					or  left(#Tempchi.matkDU,3)=  '154'  
							or  left(#Tempchi.matkDU,3)=  '155'  
									or  left(#Tempchi.matkDU,3)=  '156'  
											or  left(#Tempchi.matkDU,3)=  '157'  
						  )


end


begin  --loai 3
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='3'
  
      where (left(#Tempchi.matkDU,3) =  '334'   )

end



begin  --loai 4
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='4'
  
      where left(#Tempchi.matkDU,3) =  '635' 
	             and #Tempchi.machitiet =  '0' -- chi ti?t lai vay m == 0

end



begin  --loai 5
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='5'
  
      where left(#Tempchi.matkDU,4) =  '3334' 
	          
end

-- PS N? 111+112 / C 711, 133, 141, 244(cc kho?n THU khc t? ho?t d?ng KD m ko thu?c ch? tiu 01)

---PS C 111+112+113 / N? 211, 213, 217, 241 

begin  --loai 21
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='21'
     where (left(#Tempchi.matkDU,3) =  '211' 
	          or left(#Tempchi.matkDU,3) =  '213' 
			     or left(#Tempchi.matkDU,3) =  '217' 
				  )
								   and  #Tempchi.stat ='0'

end


begin  --loai 31
 UPDATE  #Tempthu
         SET 
#Tempthu.stat ='31'
     where (left(#Tempthu.matkDU,3) =  '411' 
	         
			   
				  )
								   and  #Tempthu.stat ='0'

end


begin  --loai 32
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='32'
     where (left(#Tempchi.matkDU,3) =  '411' 
	         
			   
				  )
								   and  #Tempchi.stat ='0'

end

begin  --loai 33
 UPDATE  #Tempthu
         SET 
#Tempthu.stat ='33'
     where (left(#Tempthu.matkDU,4) =  '3411' 
	         
			 --or  left(#Tempthu.matkDU,3) =  '342' 
				  )
								   and  #Tempthu.stat ='0'

end


begin  --loai 34
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='34'
     where (left(#Tempchi.matkDU,4) =  '3411' 
	         
				 --or  left(#Tempchi.matkDU,3) =  '342'    
				  )
								   and  #Tempchi.stat ='0'

end


begin  --loai 35
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='35'
     where (left(#Tempchi.matkDU,4) =  '3412' 
	         
				 --or  left(#Tempchi.matkDU,3) =  '342'    
				  )
								   and  #Tempchi.stat ='0'

end


begin  --loai 36
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='36'
     where (left(#Tempchi.matkDU,3) =  '421' 
	         
				 --or  left(#Tempchi.matkDU,3) =  '342'    
				  )
								   and  #Tempchi.stat ='0'

end


begin  --loai 61
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='61'
     where (left(#Tempchi.matkDU,3) =  '412' 
	         
				 --or  left(#Tempchi.matkDU,3) =  '342'    
				  )
								   and  #Tempchi.stat ='0'

end

begin  --loai 61
 UPDATE  #Tempthu
         SET 
#Tempthu.stat ='61'
     where (left(#Tempthu.matkDU,3) =  '412' 
	         
			 --or  left(#Tempthu.matkDU,3) =  '342' 
				  )
								   and  #Tempthu.stat ='0'

end


begin  --loai 22
 UPDATE  #Tempthu
         SET 
#Tempthu.stat ='22'
     where (left(#Tempthu.matkDU,3) =  '711' 
	         
			or  left(#Tempthu.matkDU,4) =  '5117' 
				or  left(#Tempthu.matkDU,3) =  '131' 
				
				  )
								   and  #Tempthu.stat ='0'

end
  

begin  --loai 22
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='22'
     where (left(#Tempchi.matkDU,3) =  '632' 
	         
			or  left(#Tempchi.matkDU,3) =  '811' 
			--	or  left(#Tempchi.matkDU,3) =  '131' 
				
				  )
								   and  #Tempchi.stat ='0'

end					


begin  --loai 23
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='23'
     where (left(#Tempchi.matkDU,3) =  '128' 
	         
			or  left(#Tempchi.matkDU,3) =  '171' 
			--	or  left(#Tempchi.matkDU,3) =  '131' 
				
				  )
								   and  #Tempchi.stat ='0'

end			


begin  --loai 24
 UPDATE  #Tempthu
         SET 
#Tempthu.stat ='24'
     where (left(#Tempthu.matkDU,3) =  '128' 
	         
			or  left(#Tempthu.matkDU,4) =  '171' 
			
				
				  )
								   and  #Tempthu.stat ='0'

end
  

begin  --loai 25
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='25'
     where (left(#Tempchi.matkDU,3) =  '211' 
	         
			or  left(#Tempchi.matkDU,3) =  '222' 
			or  left(#Tempchi.matkDU,4) =  '2281' 
				
				  )
								   and  #Tempchi.stat ='0'

end			

begin  --loai 26
 UPDATE  #Tempthu
         SET 
#Tempthu.stat ='26'
     where (left(#Tempthu.matkDU,3) =  '221' 
	         
			or  left(#Tempthu.matkDU,3) =  '222' 
			
					or  left(#Tempthu.matkDU,4) =  '2281' 
				  )
								   and  #Tempthu.stat ='0'

end
  
  
begin  --loai 27
 UPDATE  #Tempthu
         SET 
#Tempthu.stat ='27'
     where (left(#Tempthu.matkDU,3) =  '515' 
	         
	--		or  left(#Tempthu.matkDU,3) =  '222' 
			
			--		or  left(#Tempthu.matkDU,4) =  '2281' 
				  )
								   and  #Tempthu.stat ='0'

end	



begin -- loai 6
 UPDATE  #Tempthu
         SET 
#Tempthu.stat ='6'
  where 
  --(left(#Tempthu.matkDU,3) =  '711'  
		--				  or  left(#Tempthu.matkDU,4)=  '133'  
		--				  	  or  left(#Tempthu.matkDU,3)=  '141'  
		--					  	  or ( (left(#Tempthu.matkDU,3)=  '244' ) 
		--						  and (#Tempthu.machitiet <> '1'	)  )
	 --)
	   #Tempthu.stat ='0'

end
-- PS C 111+112+113 / N? 811, 161, 244, 333, 338, 344, 352, 353, 356(cc kho?n CHI khc t? ho?t d?ng KD m ko thu?c ch? tiu 02+03+04+05)								 

begin  --loai 7
 UPDATE  #Tempchi
         SET 
#Tempchi.stat ='7'
    where
    --(left(#Tempchi.matkDU,3) =  '811' 
	     --     or left(#Tempchi.matkDU,3) =  '161' 
			   --  or left(#Tempchi.matkDU,3) =  '244' 
				  --  or left(#Tempchi.matkDU,3) =  '333' 
					 --  or left(#Tempchi.matkDU,3) =  '338' 
					 --     or left(#Tempchi.matkDU,3) =  '344' 
						--     or left(#Tempchi.matkDU,3) =  '352' 
						--	    or left(#Tempchi.matkDU,3) =  '353' 
						--		   or left(#Tempchi.matkDU,3) =  '356' )   and
								   #Tempchi.stat ='0'

end
	begin  -- udate lchuyen tien te

  UPDATE  RPtdetaillchuyenttttiep
         SET 
	--PS N? 111+112 / C 511,3331,131, 515,121 (515,121 chi ti?t s? ti?n thu t? bn ch?ng khon kinh doanh)	
RPtdetaillchuyenttttiep.nn01thudthu = isnull( (select sum(#Tempthu.tPSNo) from #Tempthu 
                         where #Tempthu.stat ='1'	 ),'0'),

-- PS C 111+112 / N? 331, 151, 152, 153, 154, 155, 156, 157,
RPtdetaillchuyenttttiep.nn02chiccap = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi  
                         where #Tempchi.stat ='2'	 ),'0'),
							 
-- 	 PS C 111+112 / N? 334
RPtdetaillchuyenttttiep.nn03chilaodong = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi  
                         where #Tempchi.stat ='3'	 ),'0'),

                   

					
-- PS C 111+112+113 / N? 635-chi ti?t li vay
RPtdetaillchuyenttttiep.nn04chilaivay = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi  
                         where #Tempchi.stat ='4'	 ),'0'),

				 

-- PS C 111+112+113 / N? 3334

RPtdetaillchuyenttttiep.nn05chithuetndn =  isnull( (select sum(#Tempchi.tPSCo) from #Tempchi  
                        where #Tempchi.stat ='5'	 ),'0'),

-- PS N? 111+112 / C 711, 133, 141, 244(cc kho?n THU khc t? ho?t d?ng KD m ko thu?c ch? tiu 01)
			
RPtdetaillchuyenttttiep.nn06thukhac = isnull( (select sum(#Tempthu.tPSNo) from #Tempthu 
                         where #Tempthu.stat ='6'	 ),'0'),

								 
-- PS C 111+112+113 / N? 811, 161, 244, 333, 338, 344, 352, 353, 356(cc kho?n CHI khc t? ho?t d?ng KD m ko thu?c ch? tiu 02+03+04+05)								 
	RPtdetaillchuyenttttiep.nn07chikhac = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi  
                         where #Tempchi.stat ='7'	 ),'0'),

	
						 
								 
-- 20 = 01 + 02 + 03 + 04 + 05 + 06 + 07

	
---PS C 111+112+113 / N? 211, 213, 217, 241 
RPtdetaillchuyenttttiep.nn21chitsan = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi  
                         where #Tempchi.stat ='21'	 ),'0'),

					
-- Chnh l?ch duong (+) ho?c m (-) gi?a:
-- Thu: PS n? 111+112+113 / C 711, 5117, 131), v
-- Chi (PS c 111+112+113 / N? 632, 811)
--chi ti?t v? thanh l, nhu?ng bn TSC, BST v cc ti s?n di h?n khc
		
RPtdetaillchuyenttttiep.nn22thutaisan = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi  
                         where #Tempchi.stat ='22'	 ),'0')
						 + isnull( (select sum(#Tempthu.tPSNo) from #Tempthu  
                         where #Tempthu.stat ='22'	 ),'0') ,
								 
	--PS C 111+112+113 / N? 128, 171 							 
	
RPtdetaillchuyenttttiep.nn23chichovay = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi  
                         where #Tempchi.stat ='23'	 ),'0'),	

--  PS N? 111+112+113 / C 128, 171 
	
RPtdetaillchuyenttttiep.nn24thuchovay = isnull( (select sum(#Tempthu.tPSNo) from #Tempthu 
                         where #Tempthu.stat ='24'	 ),'0'),


-- PS C 111+112+113 / N? 221, 222, 2281
	
RPtdetaillchuyenttttiep.nn25chidtdonvikhac = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi  
                         where #Tempchi.stat ='25'	 ),'0'),

-- PS N? 111+112+113 / C 221, 222, 2281
		
RPtdetaillchuyenttttiep.nn26thudtdonvikhac = isnull( (select sum(#Tempthu.tPSNo) from #Tempthu 
                         where #Tempthu.stat ='26'	 ),'0'),
								 
								 
--  PS N? 111+112+113 / C 515 (li, c? t?c, l?i nhu?n du?c chia)

		
RPtdetaillchuyenttttiep.nn27thulaicotuc = isnull( (select sum(#Tempthu.tPSNo) from #Tempthu 
                         where #Tempthu.stat ='27'	 ),'0'),
								 
								 
-- 	30 = 21 + 22 + 23 + 24 + 25 + 26 + 27
-- Ti?n thu t? pht hnh c? phi?u, nh?n v?n gp c?a ch? s? h?u
RPtdetaillchuyenttttiep.nn31thucophieu = isnull( (select sum(#Tempthu.tPSNo) from #Tempthu 
                         where #Tempthu.stat ='31'	 ),'0'),

RPtdetaillchuyenttttiep.nn32chitravon = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi 
                         where #Tempchi.stat ='32'	 ),'0'),

RPtdetaillchuyenttttiep.nn33thudivay = isnull( (select sum(#Tempthu.tPSNo) from #Tempthu 
                         where #Tempthu.stat ='33'	 ),'0'),
RPtdetaillchuyenttttiep.nn34tragoc = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi 
                         where #Tempchi.stat ='34'	 ),'0'),

RPtdetaillchuyenttttiep.nn35tragocthue = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi 
                         where #Tempchi.stat ='35'	 ),'0'),

RPtdetaillchuyenttttiep.nn36tracotuc = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi 
                         where #Tempchi.stat ='36'	 ),'0'),

RPtdetaillchuyenttttiep.nn61tientygia = isnull( (select sum(#Tempchi.tPSCo) from #Tempchi 
                         where #Tempchi.stat ='61'	 ),'0')
						 + isnull( (select sum(#Tempthu.tPSNo) from #Tempthu 
                         where #Tempthu.stat ='61'	 ),'0'),

				 
RPtdetaillchuyenttttiep.nt02chiccap = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =2
						 
						  ),'0'),


RPtdetaillchuyenttttiep.nt03chilaodong = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =3
						 
						  ),'0'),
						  			

RPtdetaillchuyenttttiep.nt04chilaivay = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =4
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt05chithuetndn = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =5
						 
						  ),'0'),


RPtdetaillchuyenttttiep.nt06thukhac = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =6
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt07chikhac = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =7
						 
						  ),'0'),

RPtdetaillchuyenttttiep.nt21chitsan = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =21
						 
						  ),'0'),


RPtdetaillchuyenttttiep.nt22thutaisan = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =22
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt23chichovay = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =23
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt24thuchovay = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =24
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt25chidtdonvikhac = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =25
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt26thudtdonvikhac = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =26
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt27thulaicotuc = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =27
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt31thucophieu = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =31
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt32chitravon = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =32
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt33thudivay = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =33
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt34tragoc = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =34
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt35tragocthue = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =35
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt36tracotuc = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =36
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt50lltrongky = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =50
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt60tiendauky = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =60
						 
						  ),'0'),
						  
RPtdetaillchuyenttttiep.nt61tientygia = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =61
						 
						  ),'0'),
						  						  						  												 
RPtdetaillchuyenttttiep.nt01thudthu = isnull( (select sum(LTTT200Dauky.Sotien) from LTTT200Dauky 
                         where LTTT200Dauky.nam = @yearchon	
						 and LTTT200Dauky.Machitieu =1 ),'0')

								 							 					
     from RPtdetaillchuyenttttiep
	
	where RPtdetaillchuyenttttiep.username = @username
		

end


		IF OBJECT_ID(N'tempdb..#TempResults', N'U') IS NOT NULL 
        DROP TABLE #TempResults;



	end

	

